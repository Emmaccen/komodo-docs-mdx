# Lightning Network Payments

<Note>
Lightning methods are currently only available using the native AtomicDEX-API. WASM support should be available in late 2023.
</Note>

## generate_invoice

The `lightning::payments::generate_invoice` method generates an invoice to be paid by another node.

### Request Parameters

| Parameter            | Type    | Description                                                                                                                                                      |
|----------------------|---------|------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| coin                 | string  | Ticker of coin to activate.                                                                                                                                      |
| description          | string  | A note to indicate the purpose of the invoice.                                                                                                                   |
| amount_in_msat       | integer | Amount to be paid, in [millisatoshis](https://bitcoindata.science/bitcoin-units-converter.html) (A thousandth of a satoshi; the same as 0.00000000001 bitcoin.)  |
| expiry               | integer | Optional, defaults to `3600`. Seconds until the invoice expires.                                                                                                 |


#### ðŸ“Œ Example

<CodeGroup title="" tag="POST" label="lightning::payments::generate_invoice">
```json {{ mm2MethodDecorate : true }}
{
    "method": "lightning::payments::generate_invoice",
    "userpass": "MM2_RPC_PASSWORD",
    "mmrpc": "2.0",
    "params": {
        "ticker": "tBTC-lightning",
        "description": "For the burger on Tuesday",
        "amount_in_msat": 10000,
        "expiry": 600
    },
    "id": 1
}
```
</CodeGroup>

<CollapsibleSection expandedText='Hide Response' collapsedText='Show Response'>

#### Response

```json

```
</CollapsibleSection>


## send_payment

The `lightning::payments::send_payment` method sends a payment to another node.

Used to pay an invoice or send a payment via pubkey/address.


### Request Parameters

| Parameter  | Type    | Description                                                                                                                           |
|------------|---------|---------------------------------------------------------------------------------------------------------------------------------------|
| type       | string  | Ticker of the coin to query.                                                                                                          |
| payment    | object  | A standard [LightningPayment](/atomicdex/api/v20#lightning-payment) object.                                                           |


#### ðŸ“Œ Example using `invoice`

<CodeGroup title="" tag="POST" label="lightning::payments::send_payment">
```json {{ mm2MethodDecorate : true }}
{
    "userpass": "MM2_RPC_PASSWORD",
    "mmrpc": "2.0",
    "method": "lightning::payments::send_payment",
    "params": {
        "coin": "tBTC-lightning",
        "payment": {
            "type": "invoice",
            "invoice": "lntb20u1p32wwxapp5p8gjy2e79jku5tshhq2nkdauv0malqqhzefnqmx9pjwa8h83cmwqdp8xys9xcmpd3sjqsmgd9czq3njv9c8qatrvd5kumcxqrrsscqp79qy9qsqsp5m473qknpecv6ajmwwtjw7keggrwxerymehx6723avhdrlnxmuvhs54zmyrumkasvjp0fvvk2np30cx5xpjs329alvm60rwy3payrnkmsd3n8ahnky3kuxaraa3u4k453yf3age7cszdxhjxjkennpt75erqpsfmy4y" 
        }
    }
    "id": 6
}
```
</CodeGroup>

<CollapsibleSection expandedText='Hide Response' collapsedText='Show Response'>

#### Response

```json

```
</CollapsibleSection>


#### ðŸ“Œ Example using `keysend`

<CodeGroup title="" tag="POST" label="lightning::payments::send_payment">
```json {{ mm2MethodDecorate : true }}
{
    "userpass": "MM2_RPC_PASSWORD",
    "mmrpc": "2.0",
    "method": "lightning::payments::send_payment",
    "params": {
        "coin": "tBTC-lightning",
        "payment": {
            "type": "keysend",
            "destination": "038863cf8ab91046230f561cd5b386cbff8309fa02e3f0c3ed161a3aeb64a643b9",
            "amount_in_msat": 1000,
            "expiry": 24
        }
    }
    "id": 6
}
```
</CodeGroup>

<CollapsibleSection expandedText='Hide Response' collapsedText='Show Response'>

#### Response

```json

```
</CollapsibleSection>


## get_payment_details

The `lightning::payments::get_payment_details` method returns details about a lightning payment from a given `payment_hash`.


### Request Parameters

| Parameter            | Type    | Description                                                                                                                           |
|----------------------|---------|---------------------------------------------------------------------------------------------------------------------------------------|
| coin                 | string  | Ticker of the coin to query.                                                                                                          |
| payment_hash         | string  | The hexidecimal string which identifies a invoice. The `payment_hash` is returned from a `lightning::payments::send_payment` request. |


#### ðŸ“Œ Example

<CodeGroup title="" tag="POST" label="lightning::payments::get_payment_details">
```json {{ mm2MethodDecorate : true }}
{
    "method": "lightning::payments::get_payment_details",
    "userpass": "MM2_RPC_PASSWORD",
    "mmrpc": "2.0",
    "params": {
        "ticker": "tBTC-lightning",
        "payment_hash": "414f9b3524fc4e48c99f2723952732d8bc2eba1b35ce3bf2a70f5144b40f599e"
    },
    "id": 1
}
```
</CodeGroup>

<CollapsibleSection expandedText='Hide Response' collapsedText='Show Response'>

#### Response

```json

```
</CollapsibleSection>


## list_payments_by_filter

The `lightning::payments::list_payments_by_filter` method returns a list of payments and invoices for a given coin which match the given filter.

### Request Parameters

| Parameter         | Type    | Description                                                                                                                  |
|-------------------|---------|------------------------------------------------------------------------------------------------------------------------------|
| coin              | string  | Ticker of the coin to query.                                                                                                 |
| filter            | object  | Optional. A standard [LightningPaymentFilter](/atomicdex/api/v20#lightning-payment-filter) object.                                                 |
| paging_options    | object  | Optional. A standard [Pagination](/atomicdex/api/v20#pagination) object.                                                     |
| limit             | integer | Optional, defaults to `10`. Maximum number of results to return.                                                             |


#### ðŸ“Œ Example without filter

<CodeGroup title="" tag="POST" label="lightning::payments::list_payments_by_filter">
```json {{ mm2MethodDecorate : true }}
{
    "method": "lightning::payments::list_payments_by_filter",
    "userpass": "MM2_RPC_PASSWORD",
    "mmrpc": "2.0",
    "params": {
        "coin": "tBTC-lightning"
    },
    "id": 1
}
```
</CodeGroup>

<CollapsibleSection expandedText='Hide Response' collapsedText='Show Response'>

#### Response

```json

```
</CollapsibleSection>


#### ðŸ“Œ Example for Inbound Payment `payment_type`, `limit` and `pagination`

<CodeGroup title="" tag="POST" label="lightning::payments::list_payments_by_filter">
```json {{ mm2MethodDecorate : true }}
{
    "method": "lightning::payments::list_payments_by_filter",
    "userpass": "MM2_RPC_PASSWORD",
    "mmrpc": "2.0",
    "params": {
        "coin": "tBTC-lightning"
        "filter": {
            "payment_type": {
                "type": "Inbound Payment"
            },
        },
        "limit": 10,
        "paging_options": {
            "PageNumber": 3
        }
    },
    "id": 1
}
```
</CodeGroup>

<CollapsibleSection expandedText='Hide Response' collapsedText='Show Response'>

#### Response

```json

```
</CollapsibleSection>



#### ðŸ“Œ Example for `pending` payments between 10000 and 40000 millisatoshis

<CodeGroup title="" tag="POST" label="lightning::payments::list_payments_by_filter">
```json {{ mm2MethodDecorate : true }}
{
    "method": "lightning::payments::list_payments_by_filter",
    "userpass": "MM2_RPC_PASSWORD",
    "mmrpc": "2.0",
    "params": {
        "coin": "tBTC-lightning"
        "filter": {
            "status": "pending",
            "from_amount_msat": 10000,
            "to_amount_msat": 40000
        }
    },
    "id": 1
}
```
</CodeGroup>

<CollapsibleSection expandedText='Hide Response' collapsedText='Show Response'>

#### Response

```json

```
</CollapsibleSection>



#### ðŸ“Œ Example for successful payments on the 20th of April 2023

<CodeGroup title="" tag="POST" label="lightning::payments::list_payments_by_filter">
```json {{ mm2MethodDecorate : true }}
{
    "method": "lightning::payments::list_payments_by_filter",
    "userpass": "MM2_RPC_PASSWORD",
    "mmrpc": "2.0",
    "params": {
        "coin": "tBTC-lightning"
        "filter": {
            "status": "succeeded",
            "from_timestamp": 1681948800,
            "to_timestamp": 1682035199
        }
    },
    "id": 1
}
```
</CodeGroup>

<CollapsibleSection expandedText='Hide Response' collapsedText='Show Response'>

#### Response

```json

```
</CollapsibleSection>

