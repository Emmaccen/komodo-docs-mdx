export const title = "AtomicDEX: HD Account Management Tasks";
export const description = "The methods in this document allow tracking of balances across multiple addresses under a specified account index.";

# HD Account Managment

If you have activated a coin with the [task::enable\_utxo::init](/atomicdex/api/v20-dev/task_enable_utxo/#init) or [task::enable\_qtum::init](/atomicdex/api/v20-dev/task_enable_qtum/#init) and are using `HD Mode`, your funds may be spread across a range of addresses under a specified account index. The methods below will return the combined balance of your account, detailing the balance for each active account address.

## task\_create\_new\_account\_init

Use the `task::create_new_account::init` method to initialise a HD account.

#### Arguments

| Parameter   | Type   | Description                                                                                                                             |
| ----------- | ------ | --------------------------------------------------------------------------------------------------------------------------------------- |
| coin        | string | Ticker of coin you would like to initialise a HD account for.                                                                           |
| account\_id | string | Optional. If not defined, will increment to the next unused account id in the wallet.                                                   |
| scan        | string | Optional. If `true`, will scan the account for funded addresses. Defaults to `true`.                                                    |
| gap\_limit  | string | Optional. The maximum number of empty addresses in a row. Defaults to the value provided on activation, or 20 if no value was provided. |

#### Response

| Parameter | Type    | Description                                               |
| --------- | ------- | --------------------------------------------------------- |
| task\_id  | integer | An identifying number which is used to query task status. |

#### ðŸ“Œ Examples

#### Command

<CodeGroup title="" tag="POST" label="task::account_balance::init" mm2MethodDecorate="true">
  ```json
  {
    "userpass": "testpsw",
    "mmrpc": "2.0",
    "method": "task::create_new_account::init",
    "params": {
      "coin": "KMD",
      "account_id": 77,
      "scan": true,
      "gap_limit": 20
    }
  }
  ```
</CodeGroup>

<CollapsibleSection expandedText="Hide Response" collapsedText="Show Response">
  #### Response (ready, successful)

  ```json
  {
    "mmrpc": "2.0",
    "result": {
      "task_id": 6
    },
    "id": null
  }
  ```
</CollapsibleSection>

## task\_create\_new\_account\_status

Use the `task::create_new_account::status` method to query the status of a HD account creation task.

#### Arguments

| Parameter            | Type    | Description                                                                               |
| -------------------- | ------- | ----------------------------------------------------------------------------------------- |
| task\_id             | integer | The identifying number returned when initiating the withdrawal process.                   |
| forget\_if\_finished | boolean | If `false`, will return final response for completed tasks. Optional, defaults to `true`. |

#### Response

| Parameter | Type             | Description                                                                                                                                                      |
| --------- | ---------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| status    | string           | Status of the task. `Ok`, `InProgress` or `Error`.                                                                                                               |
| details   | string or object | If in progress, either `Preparing` or `RequestingAccountBalance`. Once complete, a standard [WalletAccountInfo](/atomicdex/api/v20/#wallet-account-info) object. |

#### ðŸ“Œ Examples

#### Command

<CodeGroup title="" tag="POST" label="task::account_balance::init" mm2MethodDecorate="true">
  ```json
  {
    "userpass": "testpsw",
    "mmrpc": "2.0",
    "method": "task::create_new_account::status",
    "params": {
      "task_id": 1
    }
  }
  ```
</CodeGroup>

<CollapsibleSection expandedText="Hide Response" collapsedText="Show Response">
  #### Response (ready, successful)

  ```json
  {
      "mmrpc": "2.0",
      "result": {
          "status": "Ok",
          "details": {
              "account_index": 77,
              "derivation_path": "m/44'/141'/77'",
              "total_balance": {
                  "spendable": "7.777",
                  "unspendable": "0"
              },
              "addresses": [
                  {
                      "address": "RMsnNdVfZbxWwDxJafc6scbaN1xYVoR7Gx",
                      "derivation_path": "m/44'/141'/77'/0/4",
                      "chain": "External",
                      "balance": {
                          "spendable": "0",
                          "unspendable": "0"
                      }
                  },
                  {
                      "address": "R9roM4acnrrp1BL73MXd9EWdF5biRcSJ5X",
                      "derivation_path": "m/44'/141'/77'/0/5",
                      "chain": "External",
                      "balance": {
                          "spendable": "0",
                          "unspendable": "0"
                      }
                  },
                  {
                      "address": "RLNu8gszQ8ENUrY3VSyBS2714CNVwn1f7P",
                      "derivation_path": "m/44'/141'/77'/0/7",
                      "chain": "External",
                      "balance": {
                          "spendable": "7.777",
                          "unspendable": "0"
                      }
                  }
              ]
          }
      },
      "id": null
  }
  ```

  #### Response (in progress)

  ```json
  {
    "mmrpc": "2.0",
    "result": {
        "status": "InProgress",
        "details": "Preparing"
    },
    "id": null
  }
  ```
</CollapsibleSection>

## task\_account\_balance\_init

Use the `task::account_balance::init` method to initialise an account balance request.

#### Arguments

| Parameter      | Type   | Description                                                                                                                                     |
| -------------- | ------ | ----------------------------------------------------------------------------------------------------------------------------------------------- |
| coin           | string | Ticker of activated coin you want to see addresses and balance for                                                                              |
| account\_index | string | For GUIs, this will be zero. In CLI you can use other values if you [know what you are doing](https://learnmeabitcoin.com/technical/hd-wallets) |

#### Response

| Parameter | Type    | Description                                               |
| --------- | ------- | --------------------------------------------------------- |
| task\_id  | integer | An identifying number which is used to query task status. |

#### ðŸ“Œ Examples

#### Command

<CodeGroup title="" tag="POST" label="task::account_balance::init" mm2MethodDecorate="true">
  ```json
  {
    "userpass": "testpsw",
    "mmrpc": "2.0",
    "method": "task::account_balance::init",
    "params": {
      "coin": "COIN_NAME",
      "account_index": 0
    }
  }
  ```
</CodeGroup>

<CollapsibleSection expandedText="Hide Response" collapsedText="Show Response">
  #### Response (ready, successful)

  ```json
  {
    "mmrpc": "2.0",
    "result": {
      "task_id": 6
    },
    "id": null
  }
  ```
</CollapsibleSection>

## task\_account\_balance\_status

Use the `task::account_balance::status` method to view the status / response of an account balance request.

#### Arguments

| Parameter            | Type    | Description                                                                               |
| -------------------- | ------- | ----------------------------------------------------------------------------------------- |
| task\_id             | integer | The identifying number returned when initiating the withdrawal process.                   |
| forget\_if\_finished | boolean | If `false`, will return final response for completed tasks. Optional, defaults to `true`. |

#### Response

| Parameter        | Type    | Description                                                                                                                                   |
| ---------------- | ------- | --------------------------------------------------------------------------------------------------------------------------------------------- |
| status           | string  | Status of the task (`Ok` or `Error`)                                                                                                          |
| account\_index   | integer | `ACCOUNT_ID` child in the `m/44'/COIN'/ACCOUNT_ID'/CHAIN/ADDRESS_ID` BIP44 derivation path. **Please don't confuse with the global account.** |
| derivation\_path | string  | Derivation path up to the `COIN` child. E.g. `"m/44'/141'/0'"`                                                                                |
| total\_balance   | object  | A standard [balanceInfo](/atomicdex/api/v20/#balance-info) object.                                                                            |
| addresses        | list    | A list of standard [AccountAddressInfo](/atomicdex/api/v20/#account-address-info) objects.                                                    |

#### ðŸ“Œ Examples

#### Command

<CodeGroup title="" tag="POST" label="task::account_balance::status" mm2MethodDecorate="true">
  ```json
  {
    "userpass": "testpsw",
    "mmrpc": "2.0",
    "method": "task::account_balance::status",
    "params": {
      "task_id": "1",
      "forget_if_finished": false
    }
  }
  ```
</CodeGroup>

<CollapsibleSection expandedText="Hide Response" collapsedText="Show Response">
  #### Response (ready, successful)

  ```json
  {
    "mmrpc": "2.0",
    "result": {
      "status": "Ok",
      "details": {
        "account_index": 0,
        "derivation_path": "m/44'/20'/0'",
        "total_balance": {
          "spendable": "99.999",
          "unspendable": "0"
        },
        "addresses": [
          {
            "address": "DJdsr4Mhqm1afkbxwBJfwH6236xNh5kJZU",
            "derivation_path": "m/44'/20'/0'/0/0",
            "chain": "External",
            "balance": {
              "spendable": "49.999",
              "unspendable": "0"
            }
          },
          {
            "address": "DJdsr4Mhqm1afkbxwBJfwH6236xNh5kJZU",
            "derivation_path": "m/44'/20'/0'/0/1",
            "chain": "External",
            "balance": {
              "spendable": "50",
              "unspendable": "0"
            }
          },
          {
            "address": "DJdsr4Mhqm1afkbxwBJfwH6236xNh5kJZU",
            "derivation_path": "m/44'/20'/0'/0/2",
            "chain": "External",
            "balance": {
              "spendable": "0",
              "unspendable": "0"
            }
          }
        ]
      }
    },
    "id": null
  }
  ```
</CollapsibleSection>

## task\_account\_balance\_cancel

Use the `task::account_balance::cancel` method to cancel an account balance request.

#### Arguments

| Parameter | Type    | Description                                                             |
| --------- | ------- | ----------------------------------------------------------------------- |
| task\_id  | integer | The identifying number returned when initiating the withdrawal process. |

#### Response

| Parameter    | Type   | Description                                                                            |
| ------------ | ------ | -------------------------------------------------------------------------------------- |
| result       | string | Returns with value `success` when successful, otherwise returns the error values below |
| error        | string | Description of the error                                                               |
| error\_path  | string | Used for debugging. A reference to the function in code base which returned the error  |
| error\_trace | string | Used for debugging. A trace of lines of code which led to the returned error           |
| error\_type  | string | An enumerated error identifier to indicate the category of error                       |
| error\_data  | string | Additonal context for the error type                                                   |

#### ðŸ“Œ Examples

#### Command

<CodeGroup title="" tag="POST" label="task::account_balance::cancel" mm2MethodDecorate="true">
  ```json
  {
    "userpass": "testpsw",
    "mmrpc": "2.0",
    "method": "task::account_balance::cancel",
    "params": {
      "task_id": "0",
      "forget_if_finished": false
    }
  }
  ```
</CodeGroup>

<CollapsibleSection expandedText="Hide Response" collapsedText="Show Response">
  #### Response (ready, successful)

  ```json
  {
    "mmrpc": "2.0",
    "result": "success",
    "id": null
  }
  ```

  #### Response (error, task already finished)

  ```json
  {
    "mmrpc": "2.0",
    "error": "Task is finished already",
    "error_path": "init_account_balance.manager",
    "error_trace": "init_account_balance:113] manager:104]",
    "error_type": "TaskFinished",
    "error_data": 2,
    "id": null
  }
  ```
</CollapsibleSection>

## account\_balance

The `account_balance` method will return a similarly structured response as `task::account_balance::init`, but allows you to paginate and filter the response to only `External` or `Internal` addresses.

#### Arguments

| Parameter       | Type    | Description                                                                                            |
| --------------- | ------- | ------------------------------------------------------------------------------------------------------ |
| coin            | string  | The ticker of the coin you would like to view account balances for.                                    |
| account\_index  | integer | The derivation path account index value you would like to view account balances for.                   |
| limit           | integer | Optional, defaults to `10`. Maximum number of account addresses/balances to return.                    |
| chain           | string  | The derivation path chain value you would like to view account balances for. `External`, or `Internal` |
| paging\_options | object  | Optional. A standard [Pagination](/atomicdex/api/v20/#pagination) object.                              |

#### Response

| Parameter        | Type    | Description                                                                                                                              |
| ---------------- | ------- | ---------------------------------------------------------------------------------------------------------------------------------------- |
| account\_index   | integer | The derivation path account index value you would like to view account balances for.                                                     |
| derivation\_path | string  | The The [BIP44 derivation path](https://github.com/bitcoin/bips/blob/master/bip-0044.mediawiki) of an address.                           |
| addresses        | list    | A list of standard [AccountAddressInfo](/atomicdex/api/v20/#account-address-info) objects.                                               |
| page\_balance    | object  | A standard [balanceInfo](/atomicdex/api/v20/#balance-info) object.                                                                       |
| paging\_options  | object  | A standard [Pagination](/atomicdex/api/v20/#pagination) object.                                                                          |
| skipped          | integer | The number of skipped records, with respect to the values used in `paging_options`.                                                      |
| limit            | integer | The limit that was set in the request; note that the actual number of swaps can differ from the specified limit (e.g. on the last page). |
| total            | integer | Total number of account addresses available with the selected filters.                                                                   |
| total\_pages     | integer | Total pages available with the selected filters and limit.                                                                               |

<CodeGroup title="" tag="POST" label="task::account_balance::cancel" mm2MethodDecorate="true">
  ```json
  {
    "userpass": "testpsw",
    "mmrpc": "2.0",
    "method": "account_balance",
    "params": {
      "coin": "DGB",
      "account_index": 0,
      "chain": "External",
      "limit": 1,
      "paging_options": {
        "PageNumber": 3
      }
    }
  }
  ```
</CodeGroup>

<CollapsibleSection expandedText="Hide Response" collapsedText="Show Response">
  #### Response

  ```json
  {
  	"mmrpc": "2.0",
  	"result": {
  		"account_index": 0,
  		"derivation_path": "m/44'/141'/0'",
  		"addresses": [
  			{
  				"address": "RXNtAyDSsY3DS3VxTpJegzoHU9bUX54j56",
  				"derivation_path": "m/44'/141'/0'/0/0",
  				"chain": "External",
  				"balance": {
  					"spendable": "7.64018255",
  					"unspendable": "0"
  				}
  			},
              {
                  "address": "RVyndZp3ZrhGKSwHryyM3Kcz9aq2EJrW1z",
                  "derivation_path": "m/44'/141'/0'/0/1",
                  "chain": "External",
                  "balance": {
                      "spendable": "15.44692",
                      "unspendable": "0"
                  }
              },
              {
                  "address": "REyacDqfKKjTKooRuA6yrW82AFwK8nMcRT",
                  "derivation_path": "m/44'/141'/0'/0/2",
                  "chain": "External",
                  "balance": {
                      "spendable": "0",
                      "unspendable": "0"
                  }
              }
  		],
  		"page_balance": {
  			"spendable": "23.08710255",
  			"unspendable": "0"
  		},
  		"limit": 10,
  		"skipped": 0,
  		"total": 3,
  		"total_pages": 1,
  		"paging_options": {
  			"PageNumber": 1
  		}
  	},
  	"id": null
  }
  ```
</CollapsibleSection>
